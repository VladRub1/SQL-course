## üë®üèª‚Äçüíª –î–ó ‚Ññ 7. –ì–ª–∞–≤–∞ 8. –ò–Ω–¥–µ–∫—Å—ã

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
1. [–ó–∞–¥–∞–Ω–∏–µ 1.](#–∑–∞–¥–∞–Ω–∏–µ_1)
2. [–ó–∞–¥–∞–Ω–∏–µ 3.](#–∑–∞–¥–∞–Ω–∏–µ_3)

### **–ó–∞–¥–∞–Ω–∏–µ 1.** <a name="–∑–∞–¥–∞–Ω–∏–µ_1"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –¥–ª—è –∫–∞–∫–æ–π-—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ø–æ –¥–≤—É–º
—Å—Ç–æ–ª–±—Ü–∞–º: `column1` –∏ `column2`. –í —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å —Å—Ç—Ä–æ–∫–∞, —É –∫–æ—Ç–æ—Ä–æ–π –∑–Ω–∞—á–µ–Ω–∏–µ 
–∞—Ç—Ä–∏–±—É—Ç–∞ `column1` —Ä–∞–≤–Ω–æ `ABC`, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ `column2` ‚Äî `NULL`. –ú—ã —Ä–µ—à–∏–ª–∏
–¥–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É –µ—â–µ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É —Å —Ç–∞–∫–∏–º–∏ –∂–µ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∫–ª—é—á–µ–≤—ã—Ö 
–∞—Ç—Ä–∏–±—É—Ç–æ–≤, —Ç. –µ. `column1` ‚Äî `ABC`, –∞ `column2` ‚Äî `NULL`.

–ö–∞–∫ –≤—ã –¥—É–º–∞–µ—Ç–µ, –±—É–¥–µ—Ç –ª–∏ –æ–ø–µ—Ä–∞—Ü–∏—è –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ —É—Å–ø–µ—à–Ω–æ–π –∏–ª–∏ 
–∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π? –û–±—ä—è—Å–Ω–∏—Ç–µ –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ.
</details>

–û—Ç–≤–µ—Ç:

–ù–∞ –ª–µ–∫—Ü–∏–∏ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ, —á—Ç–æ –≤ –∏–∑—É—á–∞–µ–º–æ–π –≤–µ—Ä—Å–∏–∏ PostgreSQL –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è NULL
—Å—á–∏—Ç–∞—é—Ç—Å—è –æ—Ç–ª–∏—á–Ω—ã–º–∏ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ (–∫–∞–∫ –∏ –æ—Ç –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π).

–£—á–∏—Ç—ã–≤–∞—è, —á—Ç–æ, –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤,
—É–Ω–∏–∫–∞–ª—å–Ω–æ–π –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–æ–≤, –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö –≤ –∏–Ω–¥–µ–∫—Å, —è –¥—É–º–∞—é,
—á—Ç–æ –≤ –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –ø–æ–ª—É—á–∏—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Å–∫–æ–ª—å–∫–æ —É–≥–æ–¥–Ω–æ —Å—Ç—Ä–æ–∫ —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
`column1` ‚Äî `ABC`, –∞ `column2` ‚Äî `NULL`, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –≤—Å–µ –±—É–¥—É—Ç "–æ—Ç–ª–∏—á–∞—Ç—å—Å—è"
–¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –ø–æ —Å—Ç–æ–ª–±—Ü—É `column2`. –í –±–æ–ª–µ–µ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö PostgreSQL 
—É –Ω–∞—Å –º–æ–≥–ª–∞ –±—ã –±—ã—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ –¥–æ–ø—É—Å—Ç–∏—Ç—å —Ç–∞–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–∑–¥–∞–¥–∏–º —Ç–µ—Å—Ç–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É –∏ —Å–æ–∑–¥–∞–¥–∏–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å:
```SQL
CREATE TABLE test_null_unique
(
    column1 text,
    column2 text
);

CREATE UNIQUE INDEX test_unique 
ON test_null_unique ( column1, column2 );
```
–î–æ–±–∞–≤–∏–º –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –Ω–µ–µ:
```SQL
INSERT INTO test_null_unique
VALUES ( 'ABC', null );

SELECT * FROM test_null_unique;

 column1 | column2 
---------+---------
 ABC     | 
(1 —Å—Ç—Ä–æ–∫–∞)
```
–î–æ–±–∞–≤–∏–º —Å—Ä–∞–∑—É –¥–≤–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫–∏:
```SQL
INSERT INTO test_null_unique
VALUES 
    ( 'ABC', null ),
    ( 'ABC', null )
;

SELECT * FROM test_null_unique;

 column1 | column2 
---------+---------
 ABC     | 
 ABC     | 
 ABC     | 
(3 —Å—Ç—Ä–æ–∫–∏)
```

–ö–∞–∫ –∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–ª–æ—Å—å, –∏–∑-–∑–∞ –∑–Ω–∞—á–µ–Ω–∏–π `NULL` —É –Ω–∞—Å –ø–æ–ª—É—á–∞–µ—Ç—Å—è –≤–≤–æ–¥–∏—Ç—å 
"–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ" —Å—Ç—Ä–æ–∫–∏, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞.

---
### **–ó–∞–¥–∞–Ω–∏–µ 3.** <a name="–∑–∞–¥–∞–Ω–∏–µ_3"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –∏–Ω–¥–µ–∫—Å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É, –µ—Å–ª–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ 
–∑–∞–ø—Ä–æ—Å–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–±–∏—Ä–∞–µ—Ç—Å—è –ª–∏—à—å –Ω–µ–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å—Ç—Ä–æ–∫. –ï—Å–ª–∏ –∂–µ —ç—Ç–∞ –¥–æ–ª—è
–≤–µ–ª–∏–∫–∞, —Å–∫–∞–∂–µ–º, –ø–æ–ª–æ–≤–∏–Ω–∞ —Å—Ç—Ä–æ–∫ –∏–ª–∏ –±–æ–ª–µ–µ, —Ç–æ –±–æ–ª—å—à–æ–≥–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ 
—ç—Ñ—Ñ–µ–∫—Ç–∞ –æ—Ç –Ω–∞–ª–∏—á–∏—è –∏–Ω–¥–µ–∫—Å–∞ —É–∂–µ –Ω–µ –±—É–¥–µ—Ç, –∞ –≤–æ–∑–º–æ–∂–Ω–æ –¥–∞–∂–µ, —á—Ç–æ –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏
–Ω–∏–∫–∞–∫–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞. –ù–∞—à–∞ –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —ç—Ç–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ.

–û–±—Ä–∞—Ç–∏–º—Å—è –∫ —Ç–∞–±–ª–∏—Ü–µ ¬´–ü–µ—Ä–µ–ª–µ—Ç—ã¬ª (`ticket_flights`). –í –Ω–µ–π –∏–º–µ–µ—Ç—Å—è —Å—Ç–æ–ª–±–µ—Ü
¬´–ö–ª–∞—Å—Å –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è¬ª (`fare_conditions`), –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
—Ç–µ–º, —á—Ç–æ –≤ –Ω–µ–º –º–æ–≥—É—Ç –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ª–∏—à—å —Ç—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è: `Comfort`,
`Business` –∏ `Economy`.

–ï—Å–ª–∏ —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä –≤ —É—Ç–∏–ª–∏—Ç–µ `psql` –≤—ã–∫–ª—é—á–µ–Ω, —Ç–æ –≤–∫–ª—é—á–∏—Ç–µ –µ–≥–æ.

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã, –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞—é—â–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∞—Ç—Ä–∏–±—É—Ç
`fare_conditions` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–¥–Ω–æ –∏–∑ —Ç—Ä–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π. –ö–∞–∂–¥—ã–π –∏–∑
–∑–∞–ø—Ä–æ—Å–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç—Ä–∏-—á–µ—Ç—ã—Ä–µ —Ä–∞–∑–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –≤—Ä–µ–º—è –º–æ–∂–µ—Ç –Ω–µ–º–Ω–æ–≥–æ 
–∏–∑–º–µ–Ω—è—Ç—å—Å—è, –∏ –ø–æ–¥—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫, 
–∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è `count` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞. –ü—Ä–∏ —ç—Ç–æ–º
—Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ç—Ä–µ—Ö —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç–∞
`fare_conditions` –±—É–¥–µ—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ –∫–∞–∂–¥–æ–º 
—Å–ª—É—á–∞–µ –°–£–ë–î –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã.
```SQL
SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Comfort';

SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Business';

SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Economy';
```
–°–æ–∑–¥–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å –ø–æ —Å—Ç–æ–ª–±—Ü—É `fare_conditions`. –ö–æ–Ω–µ—á–Ω–æ, –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏
—Ç–∞–∫–æ–π –∏–Ω–¥–µ–∫—Å –≤—Ä—è–¥ –ª–∏ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–µ–Ω, –Ω–æ –Ω–∞–º –æ–Ω –Ω—É–∂–µ–Ω –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.

–ü—Ä–æ–¥–µ–ª–∞–π—Ç–µ —Ç–µ –∂–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å —Ç–∞–±–ª–∏—Ü–µ–π `ticket_flights`. –ë—É–¥–µ—Ç –ª–∏ 
—Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç–∞
`fare_conditions`? –ü–æ—á–µ–º—É —ç—Ç–æ –∏–º–µ–µ—Ç –º–µ—Å—Ç–æ?

–í –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —ç—Ç–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –æ—Ç–º–µ—Ç–∏–º, —á—Ç–æ –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ 
–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∏–Ω–¥–µ–∫—Å–∞ –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ
—ç—Ñ—Ñ–µ–∫—Ç–∞, –Ω–æ –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç.
</details>

–û—Ç–≤–µ—Ç:

–í–∫–ª—é—á–∏–º —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–∞:
```SQL
\timing on

SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Comfort';

SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Business';

SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Economy';
```
1. –ö–ª–∞—Å—Å "`Comfort`". –°—Ç—Ä–æ–∫: 17291, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: **289,3 –º—Å**
    1. 553,385 –º—Å
    2. 221,533 –º—Å
    3. 230,016 –º—Å
    4. 221,420 –º—Å
    5. 220,352 –º—Å
2. –ö–ª–∞—Å—Å "`Business`". –°—Ç—Ä–æ–∫: 107642, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: **225,1 –º—Å**
    1. 225,968 –º—Å
    2. 229,173 –º—Å
    3. 230,284 –º—Å
    4. 225,187 –º—Å
    5. 219,685 –º—Å
3. –ö–ª–∞—Å—Å "`Economy`". –°—Ç—Ä–æ–∫: 920793, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: **333,0 –º—Å**
    1. 336,941 –º—Å
    2. 329,387 –º—Å
    3. 347,294 –º—Å
    4. 325,244 –º—Å
    5. 330,980 –º—Å

–ò—Ç–∞–∫, –≤—Ä–µ–º—è –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑ –∏–Ω–¥–µ–∫—Å–∞ –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ. –¢–æ–ª—å–∫–æ —ç–∫–æ–Ω–æ–º-–∫–ª–∞—Å—Å 
–Ω–µ–º–Ω–æ–≥–æ –≤—ã–±–∏–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–∏ –¥—Ä—É–≥–∏—Ö, –æ–¥–Ω–∞–∫–æ –∫ –Ω–µ–º—É –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ –±–∏–ª–µ—Ç–æ–≤
(–≤ 9 –∏ 50 —Ä–∞–∑ –±–æ–ª—å—à–µ –±–∏–∑–Ω–µ—Å-–∫–ª–∞—Å—Å–∞ –∏ –∫–æ–º—Ñ–æ—Ä—Ç–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ).

–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ, —á—Ç–æ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø–µ—Ä–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π –∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏–º–∏
–±—ã–ª–∞ —Ç–æ–ª—å–∫–æ —É –ø–µ—Ä–≤–æ–≥–æ –ø–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é –∫–æ–º—Ñ–æ—Ä—Ç-–∫–ª–∞—Å—Å–∞.

–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–¥–∏–º –∏–Ω–¥–µ–∫—Å –ø–æ —Å—Ç–æ–ª–±—Ü—É `fare_conditions`:
```SQL
CREATE INDEX ON ticket_flights ( fare_conditions ) ;

–í—Ä–µ–º—è: 1892,812 –º—Å (00:01,893)
```
–°–∞–º –∏–Ω–¥–µ–∫—Å —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–æ–ª–≥–æ.

–°–Ω–æ–≤–∞ –∑–∞–º–µ—Ä–∏–º —Å–∫–æ—Ä–æ—Å—Ç—å:
```SQL
SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Comfort';

SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Business';

SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Economy';
```
1. –ö–ª–∞—Å—Å "`Comfort`". –°—Ç—Ä–æ–∫: 17291, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: **8,6 –º—Å** (–±—ã–ª–æ 289,3 –º—Å)
    1. 13,216 –º—Å
    2. 8,639 –º—Å
    3. 7,449 –º—Å
    4. 6,803 –º—Å
    5. 6,751 –º—Å
2. –ö–ª–∞—Å—Å "`Business`". –°—Ç—Ä–æ–∫: 107642, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: **67,7 –º—Å** (–±—ã–ª–æ 225,1 –º—Å)
    1. 106,490 –º—Å
    2. 61,608 –º—Å
    3. 57,728 –º—Å
    4. 59,345 –º—Å
    5. 53,205 –º—Å
3. –ö–ª–∞—Å—Å "`Economy`". –°—Ç—Ä–æ–∫: 920793, —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è: **317,1 –º—Å** (–±—ã–ª–æ 333,0 –º—Å)
    1. 305,047 –º—Å
    2. 318,418 –º—Å
    3. 318,548 –º—Å
    4. 320,087 –º—Å
    5. 323,545 –º—Å

–í–∏–¥–∏–º —É–ª—É—á—à–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤. –ü—Ä–∏ —ç—Ç–æ–º, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ,
—á–µ–º –º–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—é –∑–∞–ø—Ä–æ—Å–∞, —Ç–µ–º –±–æ–ª—å—à–µ —Ä–∞–∑–Ω–∏—Ü–∞ 
—Å –∏ –±–µ–∑ –∏–Ω–¥–µ–∫—Å–∞. –í —Å–ª—É—á–∞–µ —Å —ç–∫–æ–Ω–æ–º-–∫–ª–∞—Å—Å–æ–º, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–º –æ–∫–æ–ª–æ 90%
–æ—Ç –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π, —Ä–∞–∑–Ω–∏—Ü—É –∏ –≤–æ–≤—Å–µ –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å —Å—Ç–∞—Ç. –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å—é,
–ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ–Ω–µ–µ 5%.

–î—É–º–∞—é, —á—Ç–æ –ø—Ä–∏—á–∏–Ω–∞ —ç—Ç–æ–≥–æ –∫—Ä–æ–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ `PostgreSQL` 
–¥–∞–∂–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–¥–µ–∫—Å –ø—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Å–ª—É—á–∞–µ. –ü—Ä–æ–≤–µ—Ä–∏–º —ç—Ç–æ:
```SQL
explain SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Economy';
                                            QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 Finalize Aggregate  (cost=16122.03..16122.04 rows=1 width=8)
   ->  Gather  (cost=16121.81..16122.02 rows=2 width=8)
         Workers Planned: 2
         ->  Partial Aggregate  (cost=15121.81..15121.82 rows=1 width=8)
               ->  Parallel Seq Scan on ticket_flights  (cost=0.00..14161.49 rows=384130 width=0)
                     Filter: ((fare_conditions)::text = 'Economy'::text)
(6 —Å—Ç—Ä–æ–∫)

–í—Ä–µ–º—è: 0,663 –º—Å
```
–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–ª–∞—Å—Å–∞ `Economy` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–Ω–¥–µ–∫—Å.
```SQL
explain SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Business';
                                                  QUERY PLAN                                                   
---------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=12384.30..12384.31 rows=1 width=8)
   ->  Bitmap Heap Scan on ticket_flights  (cost=2059.93..12116.07 rows=107291 width=0)
         Recheck Cond: ((fare_conditions)::text = 'Business'::text)
         ->  Bitmap Index Scan on ticket_flights_fare_conditions_idx  (cost=0.00..2033.11 rows=107291 width=0)
               Index Cond: ((fare_conditions)::text = 'Business'::text)
(5 —Å—Ç—Ä–æ–∫)

–í—Ä–µ–º—è: 0,652 –º—Å
```
```SQL
explain SELECT count( * )
FROM ticket_flights
WHERE fare_conditions = 'Comfort';
                                                 QUERY PLAN                                                  
-------------------------------------------------------------------------------------------------------------
 Aggregate  (cost=9392.76..9392.77 rows=1 width=8)
   ->  Bitmap Heap Scan on ticket_flights  (cost=320.47..9351.46 rows=16522 width=0)
         Recheck Cond: ((fare_conditions)::text = 'Comfort'::text)
         ->  Bitmap Index Scan on ticket_flights_fare_conditions_idx  (cost=0.00..316.34 rows=16522 width=0)
               Index Cond: ((fare_conditions)::text = 'Comfort'::text)
(5 —Å—Ç—Ä–æ–∫)

–í—Ä–µ–º—è: 0,530 –º—Å
```
–ê –¥–ª—è `Business` –∏ `Comfort` -- –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è. –ó–Ω–∞—á–∏—Ç, –¥–ª—è –Ω–∏—Ö –≤ –Ω–∞—á–∞–ª–µ –ø–æ–∏—Å–∫
–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤ –∏–Ω–¥–µ–∫—Å–µ, –∞ –∑–∞—Ç–µ–º —Å –ø–æ–º–æ—â—å—é —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏.

–£—á–∏—Ç—ã–≤–∞—è —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ –¥–ª—è —ç–∫–æ–Ω–æ–º-–∫–ª–∞—Å—Å–∞, —ç—Ç–æ –Ω–µ—Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ.

---