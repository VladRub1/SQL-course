## üë®üèª‚Äçüíª –≠–∫–∑–∞–º–µ–Ω–∞—Ü–∏–æ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
1. [–ó–∞–¥–∞–Ω–∏–µ 1.](#–∑–∞–¥–∞–Ω–∏–µ_1)

### **–ó–∞–¥–∞–Ω–∏–µ 1.** <a name="–∑–∞–¥–∞–Ω–∏–µ_1"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>

**–ó–∞–¥–∞–Ω–∏–µ**:

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é –º–æ–¥–µ–ª—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º.

–§–æ—Ä–º–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞—Ä–ø–ª–∞—Ç—ã —Ä–∞–±–æ—Ç–Ω–∏–∫–∞–º –±–∞–Ω–∫–∞: —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É –≤—ã–¥–∞–µ—Ç—Å—è –∫—Ä–µ–¥–∏—Ç –ø–æ–¥ –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç, 
—á–µ–º –¥—Ä—É–≥–∏–º –∑–∞–µ–º—â–∏–∫–∞–º. –≠—Ç–∏ –¥–µ–Ω—å–≥–∏ –ø–æ–º–µ—â–∞—é—Ç—Å—è –Ω–∞ –¥–µ–ø–æ–∑–∏—Ç –ø–æ –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Å—Ç–∞–≤–∫–µ. 
–í –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞—Ä–ø–ª–∞—Ç—ã –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ø–ª–∞—Ç–µ–∂–æ–º –ø–æ –∫—Ä–µ–¥–∏—Ç—É –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ –ø–æ –¥–µ–ø–æ–∑–∏—Ç—É –∑–∞ –º–µ—Å—è—Ü.
</details>

**–û—Ç–≤–µ—Ç**:

–ü–æ—Å–∫–æ–ª—å–∫—É –ø–æ–¥–æ–±–Ω–∞—è —Å—Ö–µ–º–∞ –≤—ã–ø–ª–∞—Ç—ã –∑–∞—Ä–∞–±–æ—Ç–Ω–æ–π –ø–ª–∞—Ç—ã –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞—Å—å –≤ –º–æ–µ–π
–±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –≤ —Ç–∞–±–ª–∏—Ü–µ `personnel` –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ —Å—Ç–æ–ª–±–µ—Ü `salary`: –æ–Ω –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å
`NULL` –∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ `0`.
–ü–æ—ç—Ç–æ–º—É —è –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—É—é —Å—Ö–µ–º—É –≤—ã–ø–ª–∞—Ç—ã –∑–∞—Ä–ø–ª–∞—Ç—ã:
* —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –Ω–µ–∫–æ—Ç–æ—Ä–∞—è (–Ω–µ–±–æ–ª—å—à–∞—è) –±–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ –∑/–ø;
* –±–∞–Ω–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —ç—Ç—É —Å—Ç–∞–≤–∫—É –≤ 100 —Ä–∞–∑, –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–∞ —ç—Ç—É —Å—É–º–º—É –∫—Ä–µ–¥–∏—Ç –∏ –¥–µ–ø–æ–∑–∏—Ç, –∫–∞–∫
  –æ–ø–∏—Å–∞–Ω–æ –≤ –∑–∞–¥–∞–Ω–∏–∏;
* –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ–∫–ª–∞–¥–∞ –±–∞–Ω–∫ –≤—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É –≤ –º–µ—Å—è—Ü –±–∞–∑–æ–≤—ã–π –æ–∫–ª–∞–¥ +
  —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –ø–ª–∞—Ç–µ–∂–æ–º –ø–æ –∫—Ä–µ–¥–∏—Ç—É –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏ –ø–æ –¥–µ–ø–æ–∑–∏—Ç—É –∑–∞ –º–µ—Å—è—Ü.

–¢–∞–∫–∂–µ –Ω–∞–ø–æ–º–Ω—é, —á—Ç–æ –≤ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –ë–î –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –Ω–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É
—Ç–∞–±–ª–∏—Ü–µ–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ (–Ω–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —è–≤–ª—è—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–∞–º–∏ 
–±–∞–Ω–∫–∞). 

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–π —Å—Ö–µ–º—ã –æ–ø–ª–∞—Ç—ã —Ç—Ä—É–¥–∞ –º–Ω–µ –Ω—É–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –≤ —Ç–∞–±–ª–∏—Ü—É  
`bank.personnel` –∏–∑–º–µ–Ω–µ–Ω–∏–µ: –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `client_id`, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º 
–æ—Ç —Ç–∞–±–ª–∏—Ü—ã `bank.clients` (–ø—É—Å–∫–∞–π –æ–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å `NULL` -- –¥–æ–ø—É—Å—Ç–∏–º, –Ω–µ –≤—Å–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
–æ–±—è–∑–∞–Ω—ã –±—ã—Ç—å –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –±–∞–Ω–∫–∞).
–¢–∞–∫–∂–µ –≤–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ç–æ–≥–¥–∞ –Ω–∞—Ä—É—à–∏—Ç—Å—è —Ç–µ–∫—É—â–µ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã, 
–≤ –∫–æ—Ç–æ—Ä–æ–π –Ω–∞—Ö–æ–¥—è—Ç—Å—è `bank.personnel` –∏ `bank.clients`, –ø–æ—Å–∫–æ–ª—å–∫—É –∏ —Ç–∞–º, –∏ —Ç–∞–º
–±—É–¥–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—è –∫–ª–∏–µ–Ω—Ç–∞, –µ—Å–ª–∏ –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–∞–Ω–∫–µ. –≠—Ç–æ –º–æ–∂–Ω–æ
—É—Å—Ç—Ä–∞–Ω–∏—Ç—å, –Ω–æ –¥–∞–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ —Ä–∞–º–∫–∏ —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è.

–ò—Ç–∞–∫, —è –≤–Ω–æ—à—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü—É `bank.personnel`:
```SQL
ALTER TABLE bank.personnel
ADD COLUMN client_id INT;

ALTER TABLE bank.personnel
ADD CONSTRAINT fk_personnel_client
FOREIGN KEY (client_id)
REFERENCES bank.clients (client_id);
```
–î–∞–ª–µ–µ —è –¥–æ–±–∞–≤–ª—è—é –¥–≤–∞ –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –≤ –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –æ—Ç–¥–µ–ª–µ–Ω–∏–µ —Å `branch_id = 1`.
–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –æ–Ω–∏ —É—Å—Ç—Ä–æ–∏–ª–∏—Å—å –≤ –±–∞–Ω–∫ 1 —è–Ω–≤–∞—Ä—è 2023 –≥. (–ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≤ 
—Ç–∞–±–ª–∏—Ü–µ `bank.personnel` —É–∫–∞–∑–∞–Ω—ã —Å–ª—É–∂–µ–±–Ω—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∞ –≤ `bank.clients` -- –ª–∏—á–Ω—ã–µ). 
–ö–∞–∫ –≥–æ–≤–æ—Ä–∏–ª–æ—Å—å –≤—ã—à–µ, —Å–¥–µ–ª–∞–µ–º –∏—Ö –±–∞–∑–æ–≤—ã–µ —Å—Ç–∞–≤–∫–∏ –Ω–µ–±–æ–ª—å—à–∏–º–∏: 10 –∏ 30 —Ç—ã—Å—è—á —Ä—É–±–ª–µ–π:
```SQL
INSERT INTO bank.personnel (branch_id, name, position, contact_info, salary, client_id)
VALUES 
    (1, '–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤', '–ê–Ω–∞–ª–∏—Ç–∏–∫', '{"email": "ivanov@example.com", "phone": "+7 900 123 45 67"}', 10000, null),
    (1, '–°–µ—Ä–≥–µ–π –í–∞—Å–∏–ª—å–µ–≤', '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç', '{"email": "vasiliev@example.com", "phone": "+7 945 656 44 75"}', 30000, null);
```
–î–∞–ª–µ–µ –æ–Ω–∏ —Å—Ä–∞–∑—É –∂–µ —Å—Ç–∞–ª–∏ –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –±–∞–Ω–∫–∞:
```SQL
INSERT INTO bank.clients (name, address, passport, inn, phone, contact_info, client_type, status)
VALUES 
('–ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤', '–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –°–æ–≤–µ—Ç—Å–∫–∞—è, –¥. 1', '7001 339789', '732281269254', '+75594796081', '{"email": "alex@example.com", "telegram": "@example"}', '—Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ', '–∞–∫—Ç–∏–≤–Ω—ã–π'),
('–°–µ—Ä–≥–µ–π –í–∞—Å–∏–ª—å–µ–≤', '–≥. –ú–æ—Å–∫–≤–∞, –ø—Ä. –ú–∏—Ä–∞, –¥. 56', '7149 213887', '191988124126', '+79905204138', '{"email": "sergey@example.com", "telegram": "@example"}', '—Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ –ª–∏—Ü–æ', '–∞–∫—Ç–∏–≤–Ω—ã–π');
```
–£–∫–∞–∂–µ–º –≤ —Ç–∞–±–ª–∏—Ü–µ `bank.personnel` –Ω–æ–≤—ã–µ `client_id` –¥–ª—è —ç—Ç–∏—Ö –¥–≤—É—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ 
(–¥–æ —ç—Ç–æ–≥–æ —è –¥–æ–±–∞–≤–∏–ª 100 –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ 300 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –æ–Ω–∏ –±—É–¥—É—Ç 101 –∏ 102 –∫–ª–∏–µ–Ω—Ç–∞–º–∏ 
–∏ 301 –∏ 302 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–º):
```SQL
UPDATE bank.personnel
SET client_id = 101
WHERE employee_id = 301;

UPDATE bank.personnel
SET client_id = 102
WHERE employee_id = 302;
```
–ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –æ–Ω–∏ –≤—ã–≥–ª—è–¥—è—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `bank.personnel`:
```SQL
SELECT employee_id, branch_id, name, position, salary, client_id  FROM personnel WHERE employee_id > 300 ;

 employee_id | branch_id |      name       |  position   |  salary  | client_id 
-------------+-----------+-----------------+-------------+----------+-----------
         301 |         1 | –ê–ª–µ–∫—Å–µ–π –ò–≤–∞–Ω–æ–≤  | –ê–Ω–∞–ª–∏—Ç–∏–∫    | 10000.00 |       101
         302 |         1 | –°–µ—Ä–≥–µ–π –í–∞—Å–∏–ª—å–µ–≤ | –ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç | 30000.00 |       102
(2 —Å—Ç—Ä–æ–∫–∏)
```
–¢–µ–ø–µ—Ä—å "–≤—ã–¥–∞–¥–∏–º" –Ω–æ–≤—ã–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –∫—Ä–µ–¥–∏—Ç, –≤ 100 —Ä–∞–∑ –ø—Ä–µ–≤—ã—à–∞—é—â–∏–π –∏—Ö –±–∞–∑–æ–≤—É—é —Å—Ç–∞–≤–∫—É 
(–∑–¥–µ—Å—å –∏ –¥–∞–ª–µ–µ —è –±—É–¥—É –¥–æ—Å—Ç–∞–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é —Å—Ç–∞–≤–∫—É —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å, –∑–Ω–∞—è `client_id` –Ω–æ–≤—ã—Ö
—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –≤ —Ü–µ–ª—è—Ö —É–¥–æ–±—Å—Ç–≤–∞ –∏ –¥–ª—è —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º –æ 
–∑–∞—Ä–ø–ª–∞—Ç–∞—Ö). –í—ã–¥–∞–¥–∏–º –ª—å–≥–æ—Ç–Ω—ã–π –∫—Ä–µ–¥–∏—Ç –ø–æ–¥ 3% –≥–æ–¥–æ–≤—ã—Ö, —Ç–∞–∫–∂–µ —É–∫–∞–∂–µ–º –≤ `terms`,
—á—Ç–æ —ç—Ç–æ –∫—Ä–µ–¥–∏—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É:
```SQL
INSERT INTO bank.loans (client_id, amount, interest_rate, issue_date, maturity_date, status, terms)
VALUES 
    (101, (SELECT salary FROM bank.personnel WHERE client_id = 101) * 100, 
        0.03, '2023-01-01', '2024-01-01', '–∞–∫—Ç–∏–≤–µ–Ω', '–ö—Ä–µ–¥–∏—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É'),
    (102, (SELECT salary FROM bank.personnel WHERE client_id = 102) * 100, 
        0.03, '2023-01-01', '2024-01-01', '–∞–∫—Ç–∏–≤–µ–Ω', '–ö—Ä–µ–¥–∏—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫—É');
```
–¢–µ–ø–µ—Ä—å –≤—ã–¥–∞–¥–∏–º –Ω–∞ —Ç—É –∂–µ —Å—É–º–º—É –¥–µ–ø–æ–∑–∏—Ç. –î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å—É–º–º—ã –¥–µ–ø–æ–∑–∏—Ç–∞ —è —Å–¥–µ–ª–∞—é –ø–æ–¥–∑–∞–ø—Ä–æ—Å,
–∫–∞–∫ –∏ –¥–ª—è `loan_id`. –í—ã–¥–∞–¥–∏–º –¥–µ–ø–æ–∑–∏—Ç –ø–æ–¥ –ª—å–≥–æ—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É 23% –≥–æ–¥–æ–≤—ã—Ö.
–§—É–Ω–∫—Ü–∏—è `MAX` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —á—Ç–æ–±—ã –≤–∑—è—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫—Ä–µ–¥–∏—Ç, –∫–æ—Ç–æ—Ä—ã–π –µ—Å—Ç—å –Ω–∞ —ç—Ç–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ 
–∏ –∫–æ—Ç–æ—Ä—ã–π —Ç–æ–ª—å–∫–æ —á—Ç–æ –±—ã–ª –≤—ã–¥–∞–Ω (–≤–¥—Ä—É–≥ —É —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –µ—Å—Ç—å –µ—â–µ –¥—Ä—É–≥–∏–µ –∫—Ä–µ–¥–∏—Ç—ã):
```SQL
INSERT INTO bank.deposits (client_id, cur_id, issue_date, amount, interest_rate, maturity_date, status)
VALUES 
    (101, 643, '2023-01-01', 
     (SELECT amount FROM bank.loans WHERE loan_id = (SELECT max(loan_id) FROM bank.loans WHERE client_id = 101)), 
     0.23, '2024-01-01', '–∞–∫—Ç–∏–≤–µ–Ω'),
    (102, 643, '2023-01-01', 
     (SELECT amount FROM bank.loans WHERE loan_id = (SELECT max(loan_id) FROM bank.loans WHERE client_id = 102)), 
     0.23, '2024-01-01', '–∞–∫—Ç–∏–≤–µ–Ω');
```
–ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã–µ –¥–µ–ø–æ–∑–∏—Ç—ã:
```SQL
SELECT * FROM deposits WHERE deposit_id > 500 ;

 deposit_id | client_id | cur_id | issue_date |    amount    | interest_rate | maturity_date | status  
------------+-----------+--------+------------+--------------+---------------+---------------+---------
        501 |       101 |    643 | 2023-01-01 | 1000000.0000 |      0.230000 | 2024-01-01    | –∞–∫—Ç–∏–≤–µ–Ω
        502 |       102 |    643 | 2023-01-01 | 3000000.0000 |      0.230000 | 2024-01-01    | –∞–∫—Ç–∏–≤–µ–Ω
(2 —Å—Ç—Ä–æ–∫–∏)
```
–î–∞–ª–µ–µ –ø–æ—Å—á–∏—Ç–∞–µ–º, –∫–∞–∫—É—é –∑–∞—Ä–ø–ª–∞—Ç—É –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å –∫–∞–∂–¥—ã–π –∏–∑ –¥–≤—É—Ö –Ω–æ–≤—ã—Ö —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤
–≤ —è–Ω–≤–∞—Ä–µ 2023 –≥. –ü—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π —Ä–∞—Å—Ö–æ–¥ –Ω–∞ –∫—Ä–µ–¥–∏—Ç –∏ –¥–æ—Ö–æ–¥ –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞ —è –±—É–¥—É —Å—á–∏—Ç–∞—Ç—å 
–∫–∞–∫ ((—Å—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞ –∏–ª–∏ –¥–µ–ø–æ–∑–∏—Ç–∞ * –≥–æ–¥–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞) / —á–∏—Å–ª–æ –¥–Ω–µ–π –≤ –≥–æ–¥—É) * —á–∏—Å–ª–æ –¥–Ω–µ–π –≤ –Ω—É–∂–Ω–æ–º –º–µ—Å—è—Ü–µ.

–ü–µ—Ä–≤—ã–π –Ω–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ —Å –±–∞–∑–æ–≤—ã–º –æ–∫–ª–∞–¥–æ–º `10000`:
```SQL
WITH credit_details AS (
    SELECT 
        loan.client_id,
        (loan.amount * loan.interest_rate / 365) AS daily_interest
    FROM bank.loans loan
    WHERE loan.client_id = 101
),
deposit_details AS (
    SELECT 
        deposit.client_id,
        (deposit.amount * deposit.interest_rate / 365) AS daily_interest
    FROM bank.deposits deposit
    WHERE deposit.client_id = 101
)
SELECT 
    (SELECT SUM(daily_interest) FROM deposit_details) * 
    (EXTRACT(day FROM AGE(DATE '2023-01-31', DATE '2023-01-01')) + 1) - 
    (SELECT SUM(daily_interest) FROM credit_details) * 
    (EXTRACT(day FROM AGE(DATE '2023-01-31', DATE '2023-01-01')) + 1) + 
    (SELECT salary FROM bank.personnel WHERE personnel.client_id = 101) AS net_income;
```
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
   net_income    
-----------------
 26986.301369863
(1 —Å—Ç—Ä–æ–∫–∞)
```

–í—Ç–æ—Ä–æ–π –Ω–æ–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ —Å –±–∞–∑–æ–≤—ã–º –æ–∫–ª–∞–¥–æ–º `30000`:
```SQL
WITH credit_details AS (
    SELECT 
        loan.client_id,
        (loan.amount * loan.interest_rate / 365) AS daily_interest
    FROM bank.loans loan
    WHERE loan.client_id = 102
),
deposit_details AS (
    SELECT 
        deposit.client_id,
        (deposit.amount * deposit.interest_rate / 365) AS daily_interest
    FROM bank.deposits deposit
    WHERE deposit.client_id = 102
)
SELECT 
    (SELECT SUM(daily_interest) FROM deposit_details) * 
    (EXTRACT(day FROM AGE(DATE '2023-01-31', DATE '2023-01-01')) + 1) - 
    (SELECT SUM(daily_interest) FROM credit_details) * 
    (EXTRACT(day FROM AGE(DATE '2023-01-31', DATE '2023-01-01')) + 1) + 
    (SELECT salary FROM bank.personnel WHERE personnel.client_id = 102) AS net_income;
```
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
   net_income    
-----------------
 80958.904109589
(1 —Å—Ç—Ä–æ–∫–∞)
```

–í–∏–¥–∏–º, —á—Ç–æ —Å —Ç–∞–∫–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –ø–æ–¥—Å—á–µ—Ç–∞ –æ–∫–ª–∞–¥–∞ –ø–µ—Ä–≤—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –¥–æ–ª–∂–µ–Ω –±—ã–ª –±—ã
–ø–æ–ª—É—á–∏—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ 26986 —Ä—É–±–ª–µ–π –∑–∞ —è–Ω–≤–∞—Ä—å 2023 –≥., –∞ –≤—Ç–æ—Ä–æ–π -- 80959 —Ä—É–±–ª–µ–π.
–í —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã —Å–¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ —É–¥–æ–±–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ
—Å–∞–º–∏ –±—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–ª–∏ –Ω—É–∂–Ω—É—é —Å—É–º–º—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –º–µ—Å—è—Ü–∞.

---
