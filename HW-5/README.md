## üë®üèª‚Äçüíª –î–ó ‚Ññ 5. –ì–ª–∞–≤–∞ 6. –ó–∞–ø—Ä–æ—Å—ã

–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:
1. [–ó–∞–¥–∞–Ω–∏–µ 2.](#–∑–∞–¥–∞–Ω–∏–µ_2)
2. [–ó–∞–¥–∞–Ω–∏–µ 7.](#–∑–∞–¥–∞–Ω–∏–µ_7)
3. [–ó–∞–¥–∞–Ω–∏–µ 9.](#–∑–∞–¥–∞–Ω–∏–µ_9)
4. [–ó–∞–¥–∞–Ω–∏–µ 13.](#–∑–∞–¥–∞–Ω–∏–µ_13)
5. [–ó–∞–¥–∞–Ω–∏–µ 19.](#–∑–∞–¥–∞–Ω–∏–µ_19)
6. [–ó–∞–¥–∞–Ω–∏–µ 21.](#–∑–∞–¥–∞–Ω–∏–µ_21)
7. [–ó–∞–¥–∞–Ω–∏–µ 23.](#–∑–∞–¥–∞–Ω–∏–µ_23)

### **–ó–∞–¥–∞–Ω–∏–µ 2.** <a name="–∑–∞–¥–∞–Ω–∏–µ_2"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–≠—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –≤—ã–±–∏—Ä–∞–µ—Ç –∏–∑ —Ç–∞–±–ª–∏—Ü—ã ¬´–ë–∏–ª–µ—Ç—ã¬ª (`tickets`) –≤—Å–µ—Ö –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ —Å 
–∏–º–µ–Ω–∞–º–∏, —Å–æ—Å—Ç–æ—è—â–∏–º–∏ –∏–∑ —Ç—Ä–µ—Ö –±—É–∫–≤ (–≤ —à–∞–±–ª–æ–Ω–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–∏ —Å–∏–º–≤–æ–ª–∞ ¬´`_`¬ª):
```SQL
SELECT passenger_name
FROM tickets
WHERE passenger_name LIKE '___ %';
```
–ü—Ä–µ–¥–ª–æ–∂–∏—Ç–µ —à–∞–±–ª–æ–Ω –ø–æ–∏—Å–∫–∞ –≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–µ `LIKE` –¥–ª—è –≤—ã–±–æ—Ä–∞ –∏–∑ —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü—ã –≤—Å–µ—Ö
–ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ —Å —Ñ–∞–º–∏–ª–∏—è–º–∏, —Å–æ—Å—Ç–æ—è—â–∏–º–∏ –∏–∑ –ø—è—Ç–∏ –±—É–∫–≤.
</details>

–û—Ç–≤–µ—Ç:

–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤—ã–≤–µ—Å—Ç–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `tickets` –≤—Å–µ—Ö –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤ —Å 
—Ñ–∞–º–∏–ª–∏—è–º–∏, —Å–æ—Å—Ç–æ—è—â–∏–º–∏ –∏–∑ –ø—è—Ç–∏ –±—É–∫–≤, –Ω—É–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–ª–µ–¥—É—é—â–∏–º 
—à–∞–±–ª–æ–Ω–æ–º: "–ª—é–±–æ–µ —á–∏—Å–ª–æ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –∏–º–µ–Ω–∏, –ø—Ä–æ–±–µ–ª, —Ñ–∞–º–∏–ª–∏—è –∏–∑ 5 —Å–∏–º–≤–æ–ª–æ–≤":
```SQL
SELECT passenger_name
FROM tickets
WHERE passenger_name LIKE '% _____';
```
```
  passenger_name  
------------------
 ILYA POPOV
 VLADIMIR POPOV
 PAVEL GUSEV
 LEONID ORLOV
 EVGENIY GUSEV
 NIKOLAY FOMIN
 EKATERINA ILINA
 ANTON POPOV
```
–ú–æ–∂–Ω–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –±—ã–ª–æ —Ç–∞–∫–∏—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤:
```SQL
SELECT count(*)
FROM (
    SELECT DISTINCT passenger_name
    FROM tickets
    WHERE passenger_name LIKE '% _____'
) as t
;

 count 
-------
   790
(1 —Å—Ç—Ä–æ–∫–∞)
```
–í–∏–¥–∏–º, —á—Ç–æ –∏—Ö –±—ã–ª–æ 790 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —á–µ–ª–æ–≤–µ–∫.

---
### **–ó–∞–¥–∞–Ω–∏–µ 7.** <a name="–∑–∞–¥–∞–Ω–∏–µ_7"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–°–∞–º—ã–µ –∫—Ä—É–ø–Ω—ã–µ —Å–∞–º–æ–ª–µ—Ç—ã –≤ –Ω–∞—à–µ–π –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏–∏ ‚Äî —ç—Ç–æ Boeing 777-300. 
–í—ã—è—Å–Ω–∏—Ç—å, –º–µ–∂–¥—É –∫–∞–∫–∏–º–∏ –ø–∞—Ä–∞–º–∏ –≥–æ—Ä–æ–¥–æ–≤ –æ–Ω–∏ –ª–µ—Ç–∞—é—Ç, –ø–æ–º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å:

```
SELECT DISTINCT departure_city, arrival_city
FROM routes r
JOIN aircrafts a ON r.aircraft_code = a.aircraft_code
WHERE a.model = 'Boeing 777-300'
ORDER BY 1;
```
```
departure_city  arrival_city
----------------+--------------
–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥  –ú–æ—Å–∫–≤–∞
–ú–æ—Å–∫–≤–∞  –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
–ú–æ—Å–∫–≤–∞  –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫
–ú–æ—Å–∫–≤–∞  –ü–µ—Ä–º—å
–ú–æ—Å–∫–≤–∞  –°–æ—á–∏
–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫  –ú–æ—Å–∫–≤–∞
–ü–µ—Ä–º—å  –ú–æ—Å–∫–≤–∞
–°–æ—á–∏  –ú–æ—Å–∫–≤–∞
(8 —Å—Ç—Ä–æ–∫)
```
–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤ —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è. –ü–∞—Ä—ã –≥–æ—Ä–æ–¥–æ–≤ 
–ø—Ä–∏–≤–µ–¥–µ–Ω—ã –ø–æ –¥–≤–∞ —Ä–∞–∑–∞: –¥–ª—è —Ä–µ–π—Å–∞ ¬´—Ç—É–¥–∞¬ª –∏ –¥–ª—è —Ä–µ–π—Å–∞ ¬´–æ–±—Ä–∞—Ç–Ω–æ¬ª. 
–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã –∫–∞–∂–¥–∞—è –ø–∞—Ä–∞ –≥–æ—Ä–æ–¥–æ–≤ –±—ã–ª–∞ 
–≤—ã–≤–µ–¥–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑:
```
departure_city  arrival_city
----------------+--------------
–ú–æ—Å–∫–≤–∞  –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫  –ú–æ—Å–∫–≤–∞
–ü–µ—Ä–º—å  –ú–æ—Å–∫–≤–∞
–°–æ—á–∏  –ú–æ—Å–∫–≤–∞
(4 —Å—Ç—Ä–æ–∫–∏)
```
</details>

–û—Ç–≤–µ—Ç:

–ß—Ç–æ–±—ã –∏–∑ –ø–∞—Ä –≥–æ—Ä–æ–¥–æ–≤ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≥–æ—Ä–æ–¥, –ø—Ä–µ–¥–ª–∞–≥–∞—é –µ—â–µ —Ä–∞–∑ 
–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `routes` –∏, –∫—Ä–æ–º–µ –æ—á–µ–≤–∏–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π –Ω–∞ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ
–≥–æ—Ä–æ–¥–∞-–æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –ø—Ä–∏–±—ã—Ç–∏—è, –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ –æ–¥–Ω–æ –ø—Ä–∞–≤–∏–ª–æ: 
`arrival_city` –∏–∑ "–ø–µ—Ä–≤–æ–π" —Ç–∞–±–ª–∏—Ü—ã –±—ã–ª –º–µ–Ω—å—à–µ (–∏–ª–∏ –±–æ–ª—å—à–µ) `arrival_city` 
–∏–∑ –≤—Ç–æ—Ä–æ–π "—Ç–∞–±–ª–∏—Ü—ã". –õ–æ–≥–∏–∫–∞ —Ç–∞–∫–∞—è: –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫ –º–µ–∂–¥—É —Å–æ–±–æ–π
–æ–¥–Ω–∞ –∏–∑ –Ω–∏—Ö —è–≤–Ω–æ –±—É–¥–µ—Ç –º–µ–Ω—å—à–µ –∏–ª–∏ –±–æ–ª—å—à–µ –¥—Ä—É–≥–æ–π -- —Ç—É –º—ã –∏ –≤–æ–∑—å–º–µ–º –≤ 
–∫–∞—á–µ—Å—Ç–≤–µ "–ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è" –ø–∞—Ä—ã:
```SQL
SELECT DISTINCT r_1.departure_city, r_1.arrival_city
FROM routes r_1
     JOIN routes r_2 ON r_1.arrival_city = r_2.departure_city
     AND r_1.departure_city = r_2.arrival_city 
     AND r_1.arrival_city < r_2.arrival_city
     JOIN aircrafts a ON r_1.aircraft_code = a.aircraft_code
WHERE a.model = 'Boeing 777-300'
ORDER BY 1;
```
–†–µ–∑—É–ª—å—Ç–∞—Ç:
```
 departure_city | arrival_city 
----------------+--------------
 –ú–æ—Å–∫–≤–∞         | –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
 –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫    | –ú–æ—Å–∫–≤–∞
 –ü–µ—Ä–º—å          | –ú–æ—Å–∫–≤–∞
 –°–æ—á–∏           | –ú–æ—Å–∫–≤–∞
(4 —Å—Ç—Ä–æ–∫–∏)
```

---
### **–ó–∞–¥–∞–Ω–∏–µ 9.** <a name="–∑–∞–¥–∞–Ω–∏–µ_9"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–î–ª—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –≤–æ–ø—Ä–æ—Å, —Å–∫–æ–ª—å–∫–æ —Ä–µ–π—Å–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–∑ –ú–æ—Å–∫–≤—ã –≤ 
–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥, –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Å–æ–≤—Å–µ–º –ø—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å:
```SQL
SELECT count( * )
FROM routes
WHERE departure_city = '–ú–æ—Å–∫–≤–∞'
AND arrival_city = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥';
count
-------
12
(1 —Å—Ç—Ä–æ–∫–∞)
```
–ê —Å –ø–æ–º–æ—â—å—é –∫–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ?
```
departure_city  arrival_city  count
----------------+-----------------+-------
–ú–æ—Å–∫–≤–∞  –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥  12
(1 —Å—Ç—Ä–æ–∫–∞)
```
</details>

–û—Ç–≤–µ—Ç:

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω—É–∂–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ –¥–≤—É–º 
–∫–æ–ª–æ–Ω–∫–∞–º: –ø–æ `departure_city` –∏ `arrival_city`, –æ—Å—Ç–∞–≤–∏–≤ –Ω—É–∂–Ω—ã–µ –Ω–∞–º 
—É—Å–ª–æ–≤–∏—è –ø–æ –∫–ª—é—á. —Å–ª–æ–≤—É `WHERE`. –¢–æ–≥–¥–∞ –∏ `departure_city`, –∏ `arrival_city` –±—É–¥–µ—Ç
–æ–¥–∏–Ω, –Ω–æ –∏—Ö –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å:
```SQL
SELECT departure_city, arrival_city, count( * )
FROM routes
WHERE departure_city = '–ú–æ—Å–∫–≤–∞'
AND arrival_city = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥'
GROUP BY departure_city, arrival_city;
```
–í—ã–≤–æ–¥:
```
 departure_city |  arrival_city   | count 
----------------+-----------------+-------
 –ú–æ—Å–∫–≤–∞         | –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ |    12
(1 —Å—Ç—Ä–æ–∫–∞)
```
–í—Å–µ –∫–∞–∫ –º—ã —Ö–æ—Ç–µ–ª–∏!

---
### **–ó–∞–¥–∞–Ω–∏–µ 13.** <a name="–∑–∞–¥–∞–Ω–∏–µ_13"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –æ —Ç–æ–º, –∫–∞–∫–æ–≤—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –±–∏–ª–µ—Ç–æ–≤
–Ω–∞ –≤—Å–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –º–æ–∂–µ—Ç —Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å:
```SQL
SELECT f.departure_city, f.arrival_city,
max( tf.amount ), min( tf.amount )
FROM flights_v f
JOIN ticket_flights tf ON f.flight_id = tf.flight_id
GROUP BY 1, 2
ORDER BY 1, 2;
```
```
departure_city  arrival_city  max  min
---------------------+---------------------+-----------+----------
–ê–±–∞–∫–∞–Ω  –ú–æ—Å–∫–≤–∞  101000.00  33700.00
–ê–±–∞–∫–∞–Ω  –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫  5800.00  5800.00
–ê–±–∞–∫–∞–Ω  –¢–æ–º—Å–∫  4900.00  4900.00
–ê–Ω–∞–¥—ã—Ä—å  –ú–æ—Å–∫–≤–∞  185300.00  61800.00
–ê–Ω–∞–¥—ã—Ä—å  –•–∞–±–∞—Ä–æ–≤—Å–∫  92200.00  30700.00
...
–Ø–∫—É—Ç—Å–∫  –ú–∏—Ä–Ω—ã–π  8900.00  8100.00
–Ø–∫—É—Ç—Å–∫  –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥  145300.00  48400.00
(367 —Å—Ç—Ä–æ–∫)
```

–ê –∫–∞–∫ –≤—ã—è–≤–∏—Ç—å —Ç–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–æ –ø—Ä–æ–¥–∞–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞?
–û–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ—à–µ–Ω–∏—è —Ç–∞–∫–æ–π: –µ—Å–ª–∏ –Ω–∞ —Ä–µ–π—Å—ã, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–µ—Å—è –ø–æ 
–∫–∞–∫–æ–º—É-—Ç–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é, –Ω–µ –±—ã–ª–æ –ø—Ä–æ–¥–∞–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞, —Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è 
–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω—ã –±—É–¥—É—Ç —Ä–∞–≤–Ω—ã `NULL`. –ù—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤—ã–±–æ—Ä–∫—É –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ:
```
departure_city  arrival_city  max  min
---------------------+---------------------+-----------+----------
–ê–±–∞–∫–∞–Ω  –ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫  
–ê–±–∞–∫–∞–Ω  –ì—Ä–æ–∑–Ω—ã–π  
–ê–±–∞–∫–∞–Ω  –ö—ã–∑—ã–ª  
–ê–±–∞–∫–∞–Ω  –ú–æ—Å–∫–≤–∞  101000.00  33700.00
–ê–±–∞–∫–∞–Ω  –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫  5800.00  5800.00
...
–ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å, –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –≤—ã—à–µ.
```
</details>

–û—Ç–≤–µ—Ç:

–ß—Ç–æ–±—ã –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—ã–ª–æ –ø—Ä–æ–¥–∞–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –±–∏–ª–µ—Ç–∞, –Ω–µ 
"—Ç–µ—Ä—è–ª–∏—Å—å", –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –æ–±—ã—á–Ω—ã–π `JOIN` (`INNER` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –Ω–∞
`LEFT OUTER JOIN`. –¢–æ–≥–¥–∞ –¥–ª—è –Ω–µ–æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `ticket_flights`
—Å—Ç—Ä–æ–∫ –±—É–¥—É—Ç –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω—ã `NULL`, –∞ `LEFT` - –ø–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ 
`flights_v` "–æ—Å–Ω–æ–≤–Ω–æ–µ" –¥–ª—è –Ω–∞—Å:
```SQL
SELECT f.departure_city, f.arrival_city,
max( tf.amount ), min( tf.amount )
FROM flights_v f
LEFT OUTER JOIN ticket_flights tf ON f.flight_id = tf.flight_id
GROUP BY 1, 2
ORDER BY 1, 2;
```
–í—ã–≤–æ–¥:
```
      departure_city      |       arrival_city       |    max    |   min    
--------------------------+--------------------------+-----------+----------
 –ê–±–∞–∫–∞–Ω                   | –ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫              |           |         
 –ê–±–∞–∫–∞–Ω                   | –ì—Ä–æ–∑–Ω—ã–π                  |           |         
 –ê–±–∞–∫–∞–Ω                   | –ö—ã–∑—ã–ª                    |           |         
 –ê–±–∞–∫–∞–Ω                   | –ú–æ—Å–∫–≤–∞                   | 101000.00 | 33700.00
 –ê–±–∞–∫–∞–Ω                   | –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫              |   5800.00 |  5800.00
 –ê–±–∞–∫–∞–Ω                   | –¢–æ–º—Å–∫                    |   4900.00 |  4900.00
 –ê–Ω–∞–¥—ã—Ä—å                  | –ú–æ—Å–∫–≤–∞                   | 185300.00 | 61800.00
 –ê–Ω–∞–¥—ã—Ä—å                  | –•–∞–±–∞—Ä–æ–≤—Å–∫                |  92200.00 | 30700.00
 –ê–Ω–∞–ø–∞                    | –ë–µ–ª–≥–æ—Ä–æ–¥                 |  18900.00 |  6300.00
 –ê–Ω–∞–ø–∞                    | –ú–æ—Å–∫–≤–∞                   |  36600.00 | 12200.00
 –ê–Ω–∞–ø–∞                    | –ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫              |           |         
```
–í —Ü–µ–ª–æ–º, –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –±—ã
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ `FULL OUTER JOIN`.

---
### **–ó–∞–¥–∞–Ω–∏–µ 19.** <a name="–∑–∞–¥–∞–Ω–∏–µ_19"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–í —Ä–∞–∑–¥–µ–ª–µ 6.4 –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º –≤ –æ–±—â–µ–º —Ç–∞–±–ª–∏—á–Ω–æ–º 
–≤—ã—Ä–∞–∂–µ–Ω–∏–∏. –ò–∑—É—á–∏—Ç–µ —ç—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å —Ä–∞–±–æ—Ç—É —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ 
–∞–ª–≥–æ—Ä–∏—Ç–º–∞:
```SQL
WITH RECURSIVE ranges ( min_sum, max_sum )
AS (
VALUES( 0, 100000 ),
( 100000, 200000 ),
( 200000, 300000 )
UNION ALL
SELECT min_sum + 100000, max_sum + 100000
FROM ranges
WHERE max_sum < ( SELECT max( total_amount ) FROM bookings )
)
SELECT * FROM ranges;
```
```
min_sum  max_sum
---------+---------
0       100000 –∏—Å—Ö–æ–¥–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏
100000  200000
200000  300000
100000  200000 —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
200000  300000
300000  400000
200000  300000 —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—Ç–æ—Ä–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
300000  400000
400000  500000
300000  400000
400000  500000
500000  600000
...
1000000  1100000 —Ä–µ–∑—É–ª—å—Ç–∞—Ç (n-3)-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
1100000  1200000
1200000  1300000
1100000  1200000 —Ä–µ–∑—É–ª—å—Ç–∞—Ç (n-2)-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏
1200000  1300000
1200000  1300000 —Ä–µ–∑—É–ª—å—Ç–∞—Ç (n-1)-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–µ–¥–ø–æ—Å–ª–µ–¥–Ω–µ–π)
(36 —Å—Ç—Ä–æ–∫)
```
–ó–¥–µ—Å—å –º—ã —Å –ø–æ–º–æ—â—å—é –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è `VALUES` —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é
—Ç–∞–±–ª–∏—Ü—É –∏–∑ —Ç—Ä–µ—Ö —Å—Ç—Ä–æ–∫, —Ö–æ—Ç—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ–º–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
—Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ `(0, 100000)`. –ï—â–µ –≤–∞–∂–Ω–æ —Ç–æ, —á—Ç–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ `UNION ALL` –Ω–µ
—É–¥–∞–ª—è–µ—Ç —Å—Ç—Ä–æ–∫–∏-–¥—É–±–ª–∏–∫–∞—Ç—ã, –ø–æ—ç—Ç–æ–º—É –º—ã –º–æ–∂–µ–º –≤–∏–¥–µ—Ç—å –≤–µ—Å—å —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å 
–ø–æ—Ä–æ–∂–¥–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–æ–∫. –ü—Ä–∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞
```
SELECT min_sum + 100000, max_sum + 100000
FROM ranges
WHERE max_sum < ( SELECT max( total_amount ) FROM bookings )
```
–∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —É—Å–ª–æ–≤–∏–∏ `WHERE`. –ò –Ω–∞ `(n-2)`-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —ç—Ç–æ
—É—Å–ª–æ–≤–∏–µ –æ—Ç—Å–µ–∏–≤–∞–µ—Ç –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É, —Ç. –∫. –ø–æ—Å–ª–µ `(n-3)`-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞
`max_sum` –≤ —Ç—Ä–µ—Ç—å–µ–π —Å—Ç—Ä–æ–∫–µ –±—ã–ª–æ —Ä–∞–≤–Ω–æ `1 300 000`.
–í–µ–¥—å –∑–∞–ø—Ä–æ—Å
`SELECT max( total_amount ) FROM bookings;`
–≤—ã–¥–∞—Å—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
```
max
------------
1204500.00
(1 —Å—Ç—Ä–æ–∫–∞)
```
–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –ø–æ—Å–ª–µ `(n-2)`-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –æ—Å—Ç–∞–µ—Ç—Å—è –≤—Å–µ–≥–æ
–¥–≤–µ —Å—Ç—Ä–æ–∫–∏, –ø–æ—Å–ª–µ `(n-1)`-–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞
—Å—Ç—Ä–æ–∫–∞.

–ó–∞–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è —É–∂–µ –Ω–µ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—Ç—Ä–æ–∫ –≤ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É,
–ø–æ—Å–∫–æ–ª—å–∫—É –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –ø–æ–¥–∞–Ω–Ω–∞—è –Ω–∞ –≤—Ö–æ–¥ –∫–æ–º–∞–Ω–¥–µ SELECT, –±—É–¥–µ—Ç 
–æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ —É—Å–ª–æ–≤–∏–µ–º `WHERE`. –†–∞–±–æ—Ç–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è.

**–ó–∞–¥–∞–Ω–∏–µ 1.** –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–π—Ç–µ –∑–∞–ø—Ä–æ—Å, –¥–æ–±–∞–≤–∏–≤ –≤ –Ω–µ–≥–æ —Å—Ç–æ–ª–±–µ—Ü `level` (–º–æ–∂–Ω–æ 
–Ω–∞–∑–≤–∞—Ç—å –µ–≥–æ –∏ `iteration`). –≠—Ç–æ—Ç —Å—Ç–æ–ª–±–µ—Ü –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–æ–º–µ—Ä —Ç–µ–∫—É—â–µ–π 
–∏—Ç–µ—Ä–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ. –ù–µ
–∑–∞–±—É–¥—å—Ç–µ –∑–∞–¥–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å—Ç–æ–ª–±—Ü–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏
`VALUES`.

**–ó–∞–¥–∞–Ω–∏–µ 2.** –î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∑–∞–º–µ–Ω–∏—Ç–µ `UNION ALL` –Ω–∞ `UNION` –∏
–≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å. –°—Ä–∞–≤–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º, –∫–æ–≥–¥–∞ –º—ã 
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `UNION ALL`.
</details>

–û—Ç–≤–µ—Ç:

**–ó–∞–¥–∞–Ω–∏–µ 1.**

–î–æ–±–∞–≤–∏–º –≤ –∑–∞–ø—Ä–æ—Å –ø–æ–ª–µ `iteration`, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç —è–≤–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å, –Ω–∞ –∫–∞–∫–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ 
–º—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è:
```SQL
WITH RECURSIVE ranges ( min_sum, max_sum, iteration )
AS (
VALUES( 0, 100000, 0 ),
( 100000, 200000, 0 ),
( 200000, 300000, 0 )
UNION ALL
SELECT min_sum + 100000, max_sum + 100000, iteration + 1
FROM ranges
WHERE max_sum < ( SELECT max( total_amount ) FROM bookings )
)
SELECT * FROM ranges;
```
–í—ã–≤–æ–¥:
```
 min_sum | max_sum | iteration 
---------+---------+-----------
       0 |  100000 |         0
  100000 |  200000 |         0
  200000 |  300000 |         0
  100000 |  200000 |         1
  200000 |  300000 |         1
  300000 |  400000 |         1

...skipping
 1000000 | 1100000 |        10
 1100000 | 1200000 |        10
 1200000 | 1300000 |        10
 1100000 | 1200000 |        11
 1200000 | 1300000 |        11
 1200000 | 1300000 |        12
(36 —Å—Ç—Ä–æ–∫)
```
–Ø–≤–Ω–æ –≤–∏–¥–∏–º, –∫–∞–∫ –∑–∞–≤–µ—Ä—à–∞–ª—Å—è –∑–∞–ø—Ä–æ—Å.

**–ó–∞–¥–∞–Ω–∏–µ 2.**

–ï—Å–ª–∏ –∑–∞–º–µ–Ω–∏—Ç—å `UNION ALL` –Ω–∞ `UNION` –∏ –æ—Å—Ç–∞–≤–∏—Ç—å –≤ –ø–æ–¥–∑–∞–ø—Ä–æ—Å–µ –ø–æ–ª–µ `iteration`, —Ä–µ–∑—É–ª—å—Ç–∞—Ç 
–Ω–µ –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è 
–æ—Ç –∑–∞–ø—Ä–æ—Å–∞ –≤—ã—à–µ, —Ç.–∫. —Å—Ç—Ä–æ–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ `min_sum` –∏ `max_sum`
–±—É–¥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ `iteration`.
```SQL
WITH RECURSIVE ranges ( min_sum, max_sum )
AS (
VALUES( 0, 100000, 0 ),
( 100000, 200000, 0 ),
( 200000, 300000, 0 )
UNION
SELECT min_sum + 100000, max_sum + 100000
FROM ranges
WHERE max_sum < ( SELECT max( total_amount ) FROM bookings )
)
SELECT * FROM ranges;
```
–í—ã–≤–æ–¥:
```
 min_sum | max_sum 
---------+---------
       0 |  100000
  100000 |  200000
  200000 |  300000
  300000 |  400000
  400000 |  500000
  500000 |  600000
  600000 |  700000
  700000 |  800000
  800000 |  900000
  900000 | 1000000
 1000000 | 1100000
 1100000 | 1200000
 1200000 | 1300000
(13 —Å—Ç—Ä–æ–∫)
```
–¢–µ–ø–µ—Ä—å –≤–∏–¥–∏–º, —á—Ç–æ –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ (–∫–∞—Ç–µ–≥–æ—Ä–∏–∏) –ø–æ–ª—É—á–∏–ª–∏—Å—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏, –æ–¥–Ω–∞–∫–æ, –∫–∞–∫ –º—ã —É–±–µ–¥–∏–ª–∏—Å—å,
—Ç–∞–∫–æ–π –∑–∞–ø—Ä–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ, –ø–æ—Å–∫–æ–ª—å–∫—É, –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ, –æ–Ω —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏
–≤ —Ç—Ä–∏ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ —Å—Ç—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Ç–µ–º —Å–æ–∫—Ä–∞—â–∞–µ—Ç –¥–æ 13 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö.

---
### **–ó–∞–¥–∞–Ω–∏–µ 21.** <a name="–∑–∞–¥–∞–Ω–∏–µ_21"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–í —Ç–µ–∫—Å—Ç–µ –≥–ª–∞–≤—ã –±—ã–ª –ø—Ä–∏–≤–µ–¥–µ–Ω –∑–∞–ø—Ä–æ—Å, –≤—ã–≤–æ–¥—è—â–∏–π —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ç
—Ä–µ–π—Å–æ–≤ –∏–∑ –ú–æ—Å–∫–≤—ã.
```SQL
SELECT DISTINCT a.city
FROM airports a
WHERE NOT EXISTS (
SELECT * FROM routes r
WHERE r.departure_city = '–ú–æ—Å–∫–≤–∞'
AND r.arrival_city = a.city
)
AND a.city <> '–ú–æ—Å–∫–≤–∞'
ORDER BY city;
```
–ú–æ–∂–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–Ω–∞ –∏–∑ –æ–ø–µ—Ä–∞—Ü–∏–π
–Ω–∞–¥ –º–Ω–æ–∂–µ—Å—Ç–≤–∞–º–∏ —Å—Ç—Ä–æ–∫: –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ, –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –∏–ª–∏ —Ä–∞–∑–Ω–æ—Å—Ç—å.

–í–º–µ—Å—Ç–æ –∑–Ω–∞–∫–∞ ¬´`?`¬ª –ø–æ—Å—Ç–∞–≤—å—Ç–µ –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –Ω–∏–∂–µ –∑–∞–ø—Ä–æ—Å–µ –Ω—É–∂–Ω–æ–µ –∫–ª—é—á–µ–≤–æ–µ 
—Å–ª–æ–≤–æ ‚Äî `UNION`, `INTERSECT` –∏–ª–∏ `EXCEPT` ‚Äî –∏ –æ–±–æ—Å–Ω—É–π—Ç–µ –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ.
```SQL
SELECT city
FROM airports
WHERE city <> '–ú–æ—Å–∫–≤–∞'
EXCEPT
SELECT arrival_city
FROM routes
WHERE departure_city = '–ú–æ—Å–∫–≤–∞'
ORDER BY city;
```
</details>

–û—Ç–≤–µ—Ç:

–Ø —Å—á–∏—Ç–∞—é, —á—Ç–æ –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ç
—Ä–µ–π—Å–æ–≤ –∏–∑ –ú–æ—Å–∫–≤—ã, –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ `EXCEPT`, –ø–æ—Å–∫–æ–ª—å–∫—É
–Ω–∞–º –Ω—É–∂–Ω–æ –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –∞—ç—Ä–æ–ø–æ—Ä—Ç—ã (–∏—Å–∫–ª—é—á–∞—è –ú–æ—Å–∫–≤—É)
–≤—ã—á–µ—Å—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–µ—Ö –≥–æ—Ä–æ–¥–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å —Ä–µ–π—Å—ã –∏–∑ –º–æ—Å–∫–≤—ã. –¢–æ–≥–¥–∞ –º—ã –∫–∞–∫ —Ä–∞–∑ –ø–æ–ª—É—á–∏–º
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ:
```SQL
SELECT city
FROM airports
WHERE city <> '–ú–æ—Å–∫–≤–∞'
?
SELECT arrival_city
FROM routes
WHERE departure_city = '–ú–æ—Å–∫–≤–∞'
ORDER BY city;
```
–í—ã–≤–æ–¥:
```
         city         
----------------------
 –ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫
 –ò–≤–∞–Ω–æ–≤–æ
 –ò—Ä–∫—É—Ç—Å–∫
 –ö–∞–ª—É–≥–∞
 –ö–æ–≥–∞–ª—ã–º
 –ö–æ–º—Å–æ–º–æ–ª—å—Å–∫-–Ω–∞-–ê–º—É—Ä–µ
 –ö—ã–∑—ã–ª
 –ú–∞–≥–∞–¥–∞–Ω
 –ù–∏–∂–Ω–µ–∫–∞–º—Å–∫
 –ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫
 –°—Ç—Ä–µ–∂–µ–≤–æ–π
 –°—É—Ä–≥—É—Ç
 –£–¥–∞—á–Ω—ã–π
 –£—Å—Ç—å-–ò–ª–∏–º—Å–∫
 –£—Å—Ç—å-–ö—É—Ç
 –£—Ö—Ç–∞
 –ß–µ—Ä–µ–ø–æ–≤–µ—Ü
 –ß–∏—Ç–∞

...skipping 1 line
 –Ø—Ä–æ—Å–ª–∞–≤–ª—å
(20 —Å—Ç—Ä–æ–∫)
```
–°—Ä–∞–≤–Ω–∏–º —Å –ø–µ—Ä–≤—ã–º –∑–∞–ø—Ä–æ—Å–æ–º:
```SQL
SELECT DISTINCT a.city
FROM airports a
WHERE NOT EXISTS (
SELECT * FROM routes r
WHERE r.departure_city = '–ú–æ—Å–∫–≤–∞'
AND r.arrival_city = a.city
)
AND a.city <> '–ú–æ—Å–∫–≤–∞'
ORDER BY city;
```
```
         city         
----------------------
 –ë–ª–∞–≥–æ–≤–µ—â–µ–Ω—Å–∫
 –ò–≤–∞–Ω–æ–≤–æ
 –ò—Ä–∫—É—Ç—Å–∫
 –ö–∞–ª—É–≥–∞
 –ö–æ–≥–∞–ª—ã–º
 –ö–æ–º—Å–æ–º–æ–ª—å—Å–∫-–Ω–∞-–ê–º—É—Ä–µ
 –ö—ã–∑—ã–ª
 –ú–∞–≥–∞–¥–∞–Ω
 –ù–∏–∂–Ω–µ–∫–∞–º—Å–∫
 –ù–æ–≤–æ–∫—É–∑–Ω–µ—Ü–∫
 –°—Ç—Ä–µ–∂–µ–≤–æ–π
 –°—É—Ä–≥—É—Ç
 –£–¥–∞—á–Ω—ã–π
 –£—Å—Ç—å-–ò–ª–∏–º—Å–∫
 –£—Å—Ç—å-–ö—É—Ç
 –£—Ö—Ç–∞
 –ß–µ—Ä–µ–ø–æ–≤–µ—Ü
 –ß–∏—Ç–∞

...skipping 1 line
 –Ø—Ä–æ—Å–ª–∞–≤–ª—å
(20 —Å—Ç—Ä–æ–∫)
```
–ü–æ–ª—É—á–∏–ª–æ—Å—å —Ç–æ –∂–µ —Å–∞–º–æ–µ!

---
### **–ó–∞–¥–∞–Ω–∏–µ 23.** <a name="–∑–∞–¥–∞–Ω–∏–µ_23"></a>

<details>
<summary>üîΩ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∑–∞–¥–∞–Ω–∏–µ üîΩ</summary>
–ó–∞–¥–∞–Ω–∏–µ:

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç —Ä–∞–∑–≤–∏—Ç–∏—è –Ω–∞—à–µ–π –∞–≤–∏–∞–∫–æ–º–ø–∞–Ω–∏–∏ –∑–∞–¥–∞–ª—Å—è 
–≤–æ–ø—Ä–æ—Å–æ–º: –∫–∞–∫–∏–º –±—É–¥–µ—Ç –æ–±—â–µ–µ —á–∏—Å–ª–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏
–º–æ–∂–Ω–æ –ø—Ä–æ–ª–æ–∂–∏—Ç—å –º–µ–∂–¥—É –≤—Å–µ–º–∏ –≥–æ—Ä–æ–¥–∞–º–∏?

–ï—Å–ª–∏ –≤ –∫–∞–∫–æ–º-—Ç–æ –≥–æ—Ä–æ–¥–µ –∏–º–µ–µ—Ç—Å—è –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞, —Ç–æ —ç—Ç–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –Ω–µ
–±—É–¥–µ–º, —Ç. –µ. –º–∞—Ä—à—Ä—É—Ç–æ–º –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å –ø—É—Ç—å –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏, –∞ –Ω–µ –º–µ–∂–¥—É 
–∞—ç—Ä–æ–ø–æ—Ä—Ç–∞–º–∏. –ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å —Å–∞–º–æ–π —Å–æ–±–æ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ
–Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –∑–Ω–∞—á–µ–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç–æ–≤.
```SQL
SELECT count( * )
FROM ( SELECT DISTINCT city FROM airports ) AS a1
JOIN ( SELECT DISTINCT city FROM airports ) AS a2
ON a1.city <> a2.city;
```
```
count
-------
10100
(1 —Å—Ç—Ä–æ–∫–∞)
```
–ó–∞–¥–∞–Ω–∏–µ. –ü–µ—Ä–µ–ø–∏—à–∏—Ç–µ —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å —Å –æ–±—â–∏–º —Ç–∞–±–ª–∏—á–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏–µ–º.
</details>

–û—Ç–≤–µ—Ç:

–í–≤–µ–¥–µ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—É—é –≤ –∑–∞–¥–∞–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—É:
```SQL
WITH cities AS ( 
    SELECT DISTINCT city 
    FROM airports 
)
SELECT count( * )
FROM cities AS a1
    JOIN cities AS a2
ON a1.city <> a2.city;
```
–í—ã–≤–æ–¥:
```
 count 
-------
 10100
(1 —Å—Ç—Ä–æ–∫–∞)
```
–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—É—á–∏–ª—Å—è —Ç–∞–∫–∏–º –∂–µ!

---